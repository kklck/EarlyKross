<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
  <head>
    <div th:replace="/fragments/head_line.html :: head_line">-- thymeleaf head_line --</div>
    <!--카카오 로그인 스크립트-->
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
<!--    <script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>-->
<!--    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>-->
<!--    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>-->
  </head>
  <body data-template="template-soccer">
    <!-- 카카오 로그인 초기화 -->
<!--    <script>-->
<!--      //SDK를 초기화 합니다. 사용할 앱의 JavaScript 키를 설정해 주세요.-->
<!--      //Kakao.init()으로 인증 객체를 초기화-->
<!--      Kakao.init('062d15d0c2b98f2e2fee568cc6853fa7')-->
<!--      //Kakao.isInitialized()로 초기화 여부를 판단-->
<!--      console.log(Kakao.isInitialized())-->
<!--    </script>-->
<!--    <script>-->
<!--      function kakaoLogin() {-->
<!--        //로그인하고-->
<!--        Kakao.Auth.login({-->
<!--          success: function (response) {-->
<!--            //사용자 정보 가져오기-->
<!--            Kakao.API.request({-->
<!--              url: '/v2/user/me', //계정 정보를 가져오는 request url-->
<!--              success: function (response) {-->
<!--                let user = response.kakao_account //카카오 계정 정보-->
<!--                console.log(user)-->
<!--                user.host = 'kakao' //다른 로그인 서비스와 구분하기 위해서 개인적으로 추가했음-->
<!--                // 해당 페이지에서 객체를 만들고 곧바로 user 정보를 사용할 수 도 있고,-->
<!--                // input 엘리먼트에 json으로 저장해뒀다가 나중에 사용할 수도 있음, 여기서는 input에 저장-->
<!--                const userinfo = document.querySelector("#userinfo")-->
<!--                if (userinfo) userinfo.value = JSON.stringify(user) //user를 json문자열로 변환해서 저장해두기-->
<!--              },-->
<!--              fail: function (error) {-->
<!--                console.log(error)-->
<!--              },-->
<!--            })-->
<!--          },-->
<!--          fail: function (error) {-->
<!--            console.log(error)-->
<!--          },-->
<!--        })-->
<!--      }-->
<!--      //로그아웃 함수-->
<!--      function kakaoLogout(){-->
<!--        if (Kakao.Auth.getAccessToken()){-->
<!--          //토큰이 있으면-->
<!--          Kakao.API.request({-->
<!--            //로그아웃하고-->
<!--            url: '/v1/user/unlink',-->
<!--            success:function (response){-->
<!--              //console.log(response)-->
<!--            },-->
<!--            fail:function (error){-->
<!--              console.log(error)-->
<!--            },-->
<!--          })-->
<!--          //토큰도 삭제-->
<!--          Kakao.Auth.setAccessToken(undefined)-->
<!--          //유저 정보도 삭제-->
<!--          const userinfoElem = document.querySelector("#userinfo")-->
<!--          if (userinfoElem) userinfoElem.value=''-->
<!--        }-->
<!--      }-->
<!--    </script>-->

<!--    &lt;!&ndash; 사용자 정보를 저장하고, 필요시에 백엔드로 보내 토큰을 만들고 쿠키에 저장 &ndash;&gt;-->
<!--    <script>-->
<!--      let user="";-->
<!--      let userinfoElem = document.querySelector("#userinfo") //유저 정보가 들어있는 input 엘리먼트-->
<!--      //1초마다 유저정보가 있는지 체크하기-->
<!--      let frame = setInterval(function (){-->

<!--        // input box 값 쿼리로 지정-->
<!--        userinfoElem = document.querySelector("#userinfo")-->

<!--        // 확인-->
<!--        console.log("유저정보 체크")-->
<!--        console.log(userinfoElem)-->
<!--        console.log(userinfoElem.value)-->

<!--        if (userinfoElem != null && userinfoElem.value != ""){-->
<!--          //유저 정보가 있으면 체크 멈추고-->
<!--          clearInterval(frame)-->
<!--          //유저 정보 저장-->
<!--          user = JSON.parse(userinfoElem.value)-->
<!--          console.log(user.profile);-->
<!--          //필요하면 백엔드로 유저정보 보내서 토큰 만들고 쿠키에 저장하기-->

<!--          console.log(user)-->
<!--          //withCredentials:true-->
<!--          axios.post('backend_url',{user:user})-->
<!--            .then(res =>{-->
<!--              console.log(`${user.username}로그인 성공`)-->
<!--            })-->
<!--            .catch(error=>{-->
<!--              console.log(error)-->
<!--            })-->
<!--        }-->
<!--      }, 1000)-->
<!--    </script>-->
    <div class="site-wrapper clearfix">
      <div class="site-overlay"></div>

      <!-- Header ================================================== -->

      <!-- Header Mobile -->
      <div th:replace="/fragments/header_mobile.html :: header_mobile">-- thymeleaf header_mobile
        --
      </div>

      <!-- Header Desktop -->
      <header class="header header--layout-1">
        <div th:replace="/fragments/header_desktop.html :: header_desktop">-- thymeleaf
          header_desktop --
        </div>
      </header>
      <!-- Header / End -->

      <!-- Pushy Panel - Dark -->
      <div th:replace="/fragments/custom_pushy_panel.html :: custom_pushy_panel">-- thymeleaf
        custom_pushy_panel --
      </div>
      <!-- Pushy Panel - Dark / End -->

      <!-- Page Heading
      ================================================== -->
      <div class="page-heading">
        <div class="container">
          <div class="row">
            <div class="col-md-10 offset-md-1">
              <h1 class="page-heading__title">Over<span class="highlight">View</span></h1>
              <ol class="page-heading__breadcrumb breadcrumb">
                <li class="breadcrumb-item"><a href="_soccer_index.html">Home</a></li>
                <li class="breadcrumb-item"><a href="_soccer_team-overview.html">Team</a></li>
                <li class="breadcrumb-item active" aria-current="page">Overview</li>
              </ol>
            </div>
          </div>
        </div>
      </div>
      <!-- Page Heading / End -->

      <!-- Team Pages Filter -->
      <nav class="content-filter">
        <div class="container">
          <a href="#" class="content-filter__toggle"></a>
          <ul class="content-filter__list">
            <li class="content-filter__item content-filter__item--active"><a
                th:href="@{team_overview.do}" class="content-filter__link"><small>LEAGUE
              OVERVIEW</small>리그 정보</a></li>
            <li class="content-filter__item "><a href="_soccer_team-roster.html"
                                                 class="content-filter__link"><small>CLUB
              INFO</small>K리그 구단</a></li>
            <li class="content-filter__item "><a href="_soccer_team-standings.html"
                                                 class="content-filter__link"><small>PLYAER
              INFO</small></a></li>
            <li class="content-filter__item "><a href="_soccer_team-last-results.html"
                                                 class="content-filter__link"><small>The
              Team</small>Latest Results</a></li>
            <li class="content-filter__item "><a href="_soccer_team-schedule.html"
                                                 class="content-filter__link"><small>The
              Team</small>Schedule</a></li>
            <li class="content-filter__item "><a href="_soccer_team-gallery.html"
                                                 class="content-filter__link"><small>The
              Team</small>Gallery</a></li>
          </ul>
        </div>
      </nav>
      <!-- Team Pages Filter / End -->

      <!-- Content
      ================================================== -->
      <div class="site-content">
        <div class="container">

          <div class="row">

            <div class="col-md-6">

              <!-- Login -->
              <div class="card">
                <div class="card__header">
                  <h4>계정 로그인</h4>
                </div>
                <div class="card__content">

                  <!-- Login Form -->
                  <form method="post" action="/login">
                    <div class="form-group">
                      <label for="username">이메일</label>
                      <input type="text" name="username" id="username" class="form-control"
                             placeholder="이메일을 입력해주세요..">
                    </div>
                    <div class="form-group">
                      <label for="password">비밀번호</label>
                      <input type="password" name="password" id="password"
                             class="form-control" placeholder="비밀번호를 입력해주세요..">
                    </div>
                    <div class="form-group form-group--password-forgot">
                      <label class="checkbox checkbox-inline">
                        <input type="checkbox" name="remember-me" id="inlineCheckbox1">이메일 기억하기
                        <span class="checkbox-indicator"></span>
                      </label>
                      <span class="password-reminder">비밀번호를 잊어 버렸습니까? <a
                          href="#">Click Here</a></span>
                    </div>
                    <div class="form-group form-group--sm">
                      <button type="submit"
                         class="btn btn-primary-inverse btn-lg btn-block">로그인</button>
                    </div>
                    <div class="row">
                      <div class="col-md-6" onclick="kakaoLogin()" style="background: #F7E600;color: black; cursor: pointer; text-align: center">
                        <div style="margin-top:10px; font-size: 12px" >
                          <img src="/assets/images/kakao_login_medium_wide.png" style="width: 15px;height: 15px;">   카카오 로그인
<!--                        <a href="javascript:kakaoLogout();">카카오 로그아웃</a>-->
<!--                        <input id="userinfo" value=""/>&lt;!&ndash;유저 정보를 저장할 input 엘리먼트&ndash;&gt;-->
                        </div>
                      </div>
                      <div class="col-md-6">
                        <button class="btn btn-google btn-icon btn-block" style="border: 1px solid black"><i
                            class="fab fa-google"></i> 구글 로그인
                        </button>
                      </div>
                    </div>
                  </form>
                  <!-- Login Form / End -->
                  <!-- Login Form / End -->

                </div>
              </div>
              <!-- Login / End -->
            </div>

            <div class="col-md-6">

              <!-- Register -->
              <div class="card">
                <div class="card__header">
                  <h4>지금 등록하기</h4>
                </div>
                <div class="card__content">

                  <!-- Register Form -->
                  <form action="/signup" method="post" id="signup">

                      <div class="form-group">
                        <label for="email">이메일</label> <button type="button" style="float: right" id="check" class="btn btn-info btn-xs">중복 체크</button>
                        <input type="email" name="email" id="email"
                               class="form-control" placeholder="이메일을 입력해주세요..">
                      </div>
                    <div class="checkmark"></div>
                      <div class="form-group">
                      <label for="name">닉네임</label>
                      <input type="text" name="name" id="name"
                             class="form-control" placeholder="닉네임을 입력해주세요..">
                    </div>

                    <div class="form-group">
                      <label for="rgpassword">비밀번호</label>
                      <input type="password" name="password" id="rgpassword"
                             class="form-control" placeholder="비밀번호를 입력해주세요..">
                    </div>
                    <div class="form-group form-group--submit">
                      <button id="btn-save" type="button" class="btn btn-default btn-lg btn-block">계정 만들기</button>
                      <!--<a href="_soocer_shop-account.html" class="btn btn-default btn-lg btn-block">계정 만들기</a>-->
                    </div>
                  </form>
                  <!-- Register Form / End -->
                </div>
              </div>
              <!-- Register / End -->
            </div>
          </div>
        </div>
      </div>

      <!-- Content / End -->


      <!-- Footer ================================================== -->
      <footer id="footer" class="footer">
        <!-- Footer Widgets -->
        <div th:replace="/fragments/footer_custom.html :: footer_custom">-- thymeleaf footer_custom
          --
        </div>
        <!-- Footer Secondary / End -->
      </footer>
      <!-- Footer / End -->


      <!-- Login/Register Tabs Modal -->
      <div th:replace="/fragments/login_register.html :: login_register">-- thymeleaf login_register
        --
      </div>
      <!-- Login/Register Tabs Modal / End -->

    </div>
    <div th:replace="/fragments/script_line.html :: script_line">-- thymeleaf script_line --</div>
  </body>
<script>
  $(function (){
    let flag = false;
    $("#check").click(function (){
      var email = $("#email").val();
      var memberDTO = {email:email};
      $.ajax({
        url:"/check",
        data: memberDTO,
        type:"POST",
        success:function (data){
          $(".checkmark").text(data);
          if(data === "사용가능합니다"){
            $(".checkmark").css("color","green");
            flag = true;
          }else{
            $(".checkmark").css("color","red");
          }
        },
        error:function(request,status,error){
          alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
        }
      })
      $("#btn-save").click(function (){
        if(flag){
          $("#signup").submit();
        }
      })
    })
  })
    Kakao.init('3512efd5b0d9522108ab16756e818589'); //발급받은 키 중 javascript키를 사용해준다.
    console.log(Kakao.isInitialized()); // sdk초기화여부판단
    //카카오로그인
    function kakaoLogin() {
      Kakao.Auth.login({
        success: function (response) {
          Kakao.API.request({
            url: '/v2/user/me',
            success: function (response) {
              console.log(response)
              console.log('이름 : ' + response.properties.nickname)
              alert(response.properties.nickname +'님 반갑습니다')
              alert(response.kakao_account.email +'님 반갑습니다')

              //페이지 이동
              // location.href = '/hello?email='+response.kakao_account.email;
              //여기서 페이지 이동이 아닌 ajax로 전송???
            },
            fail: function (error) {
              console.log(error)
            },
          })
        },
        fail: function (error) {
          console.log(error)
        },
      })
    }
    //카카오로그아웃
    function kakaoLogout() {
      if (Kakao.Auth.getAccessToken()) {
        Kakao.API.request({
          url: '/v1/user/unlink',
          success: function (response) {
            console.log(response)
          },
          fail: function (error) {
            console.log(error)
          },
        })
        Kakao.Auth.setAccessToken(undefined)
      }
    }
</script>
</html>
